apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: portfolio-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    # ğŸ‘‡ æ–°å¢é€™è¡Œï¼šå‘Šè¨´ cert-manager ä½¿ç”¨å“ªå€‹ç™¼è­‰è€…
    cert-manager.io/cluster-issuer: letsencrypt-prod
spec:
  ingressClassName: nginx
  # ğŸ‘‡ æ–°å¢é€™å¡Š TLS è¨­å®š
  tls:
  - hosts:
    - portfolio.20.210.49.222.nip.io  # è«‹ç¢ºèªé€™è£¡è·Ÿä¸‹é¢çš„ host ä¸€æ¨¡ä¸€æ¨£
    secretName: portfolio-tls-secret # é€™æ˜¯è­‰æ›¸å­˜æª”çš„åå­—ï¼Œcert-manager æœƒè‡ªå‹•å»ºç«‹
  rules:
  - host: portfolio.20.210.49.222.nip.io
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: portfolio-service
            port:
              number: 80
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: python-service
            port:
              number: 5000